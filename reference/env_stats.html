<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Environmental time series statistics — env_stats • envPred</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/yeti/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Environmental time series statistics — env_stats" />
<meta property="og:description" content="Calculates seasonality, colour of environmental noise, constancy, contingency and predictability." />
<meta property="og:image" content="/logo.png" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">envPred</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/example.html">General envPred usage</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/dbarneche/envPred/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Environmental time series statistics</h1>
    <small class="dont-index">Source: <a href='https://github.com/dbarneche/envPred/blob/master/R/env_stats.R'><code>R/env_stats.R</code></a></small>
    <div class="hidden name"><code>env_stats.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Calculates seasonality, colour of environmental noise, constancy, contingency and predictability.</p>
    </div>

    <pre class="usage"><span class='fu'><a href='https://rdrr.io/pkg/envPred/man/env_stats.html'>env_stats</a></span>(<span class='kw'>time_series</span>, <span class='kw'>dates</span>, <span class='kw'>n_states</span>, <span class='kw'>...</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>time_series</th>
      <td><p>A <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> vector containing
a raw environmental time series.</p></td>
    </tr>
    <tr>
      <th>dates</th>
      <td><p>An vector of class <code><a href='https://rdrr.io/r/base/Dates.html'>Date</a></code>
of format YYYY-MM-DD (must be in progressive chronological order).</p></td>
    </tr>
    <tr>
      <th>n_states</th>
      <td><p>is a <code><a href='https://rdrr.io/r/base/numeric.html'>numeric</a></code> vector of length 1 containing
a somewhat arbitrary number, as Colwell's method divides a continuous variable
up into discrete states. Default (arbitrary) is 11. See Details.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Arguments passed on to <code><a href='https://rdrr.io/pkg/envPred/man/seasonality_and_colour.html'>seasonality_and_colour</a></code></p><dl>
    <dt><code>delta</code></dt><dd><p>Time interval (any unit) of <code>time_series</code>.</p></dd>
    <dt><code>is_uneven</code></dt><dd><p>Is <code>time_series</code> even or unevenly distributed in time? Default is <code><a href='https://rdrr.io/r/base/logical.html'>FALSE</a></code>.</p></dd>
    <dt><code>interpolate</code></dt><dd><p>Should a linear interpolation be applied to missing values in
<code>time_series</code>? Irrelevant method if <code>is_uneven</code> is <code><a href='https://rdrr.io/r/base/logical.html'>FALSE</a></code>. Default is <code><a href='https://rdrr.io/r/base/logical.html'>FALSE</a></code>.</p></dd>
    <dt><code>show_warns</code></dt><dd><p>Should cautionary warning messages be displayed? Default is <code><a href='https://rdrr.io/r/base/logical.html'>TRUE</a></code>.
Strongly recommended for first time users.</p></dd>
    <dt><code>noise_method</code></dt><dd><p>A method for estimating the slope beta. Takes 2 possible
values: <code>'spectrum'</code> for evenly distributed time series or
<code>'lomb_scargle'</code> for unevenly distributed ones.</p></dd>
  
</dl></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An <code><a href='https://rdrr.io/r/base/data.frame.html'>data.frame</a></code> of class <code><a href='https://rdrr.io/pkg/envPred/man/envpreddata-class.html'>envpreddata</a></code>. See <code><a href='https://rdrr.io/pkg/envPred/man/envpreddata-class.html'>?envpreddata</a></code> for output details.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>To calculate seasonality, we first remove linear trends by extracting the residuals from a linear regression model fitted to the raw time series. Seasonality is estimated in two forms: 1) as the "unbounded" fraction of the total variance that is due to predictable seasonal periodicities, \(\alpha / \beta\), where \(\alpha\) is the variance of the seasonal trend, and \(\beta\) is the variance of the residual time series (i.e. the time series after the seasonal trend was removed); or 2) as the "bounded" fraction of the total variance that is due to predictable seasonal periodicities, \(\alpha / (\alpha + \beta)\). The seasonal trend is estimated by binning the time-series data into monthly intervals, averaging each month across the duration of the time series, then re-creating a seasonal time-series dataset on the same time-scale as the original data using a linear interpolation between the monthly midpoints.</p>
<p>To calculate colour, we calculate a residual time series by subtracting the corresponding seasonal value from each data point in the time series. The spectral density (i.e. variance in the residual time series) was assumed to scale with frequency, \(f\), according to an inverse power law, \(1/f^{\theta}\) (<a href='https://www.sciencedirect.com/science/article/pii/S0040580999914247'>Halley &amp; Kunin, 1999</a>; <a href='https://esajournals.onlinelibrary.wiley.com/doi/10.1890/02-3122'>Vasseur &amp; Yodzis, 2004</a>). The spectral exponent \(\theta\) is then estimated as the negative slope of the linear regression of the natural log of spectral density as a function of the natural log of frequency. White noise occurs when there is no correlation between one measurement and the next (i.e. \(\theta = 0\)), while for reddened noise, there is some correlation between measurements separated by a finite time-scale (i.e. \(\theta &gt; 0\)). Spectral density is estimated using the <code><a href='https://rdrr.io/r/stats/spectrum.html'>spectrum</a></code> function from the <span class="pkg">stats</span> R package if the time series is evenly distributed, and the Lomb–Scargle function <code><a href='https://rdrr.io/pkg/lomb/man/lsp.html'>lsp</a></code> from the <span class="pkg">lomb</span> R package if the time series is unevenly distributed (<a href='https://academic.oup.com/bioinformatics/article/22/3/310/220284'>Glynn et al. 2006</a>). Spectral densities and therefore \(\theta\) are calculated between the frequencies of \(2 / (n \Delta t)\) and \(1 / (2 \Delta t)\) (i.e. Nyquist frequency), where \(\Delta t\) is the time gap between consecutive points in the time series, and \(n\) is the number of observations in the time series.</p>
<p>For predictability, constancy, and contingency, this algorithm implements the methods described in <a href='https://onlinelibrary.wiley.com/doi/10.2307/1940366/abstract'>Colwell (1974)</a> Ecology 55: 1148–1153, doi: <a href='http://dx.doi.org/10.2307/1940366'>10.2307/1940366</a>. These three metrics can be calculated from any phenomenon known or suspected to be periodic or cyclic in time which can be scored for at least two states. Scores from each month in the cycle are then collected for as many complete cycles as possible, and the data cast as a frequency matrix with months as columns, and states as rows. Constancy (C) measures the extent to which the environment is the same for all months in all years.  Contingency (M) measures the extent to which the environmental differences between months are the same in all years. Predictability (P) is the sum of Constancy (C) and Contingency (M). Maximum predictability can be attained as a consequence of either complete constancy, complete contingency, or a combination of constancy and contingency.</p>
<p>General important notes:</p><ul>
<li><p>This function currently allows for monthly-based seasonality calculation only. This algorithm adapts the steps described in <a href='http://onlinelibrary.wiley.com/doi/10.1111/ele.12402/abstract'>Marshall and Burgess (2015)</a> Ecology Letters 18: 1461–0248, doi: <a href='http://dx.doi.org/10.1111/ele.12402'>10.1111/ele.12402</a>.</p></li>
<li><p>We advise caution for datasets in which <code>time_series</code> contains NAs. Particularly, we strongly advise setting <code>interpolate = FALSE</code> for <code>time_series</code> containing large continuous chunks of NAs because the linear interpolation might introduce substantial bias.</p></li>
<li><p><a href='http://onlinelibrary.wiley.com/doi/10.1890/02-3122/abstract'>Vasseur and Yodzis (2004)</a> Ecology 85: 1146-1152, doi: <a href='http://dx.doi.org/10.1890/02-3122'>10.1890/02-3122</a> recommend time series encompassing at least 128 months or approximately 10 years.</p></li>
<li><p>Also note that if <code>dates</code> starts and ends in different month of the year, some monthly means are estimated with relatively less precision.</p></li>
</ul>

    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Diego Barneche and Scott Burgess.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='kw'><a href='https://github.com/dbarneche/envPred'>envPred</a></span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='kw'>sst</span>)
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span>(<span class='kw'>npp</span>)
<span class='co'># all results return important</span>
<span class='co'># warning messages of which the user should be aware.</span>
<span class='co'># after double-checking that the data falls</span>
<span class='co'># within the recommended specs, set show_warns = FALSE</span>
<span class='fu'><a href='https://rdrr.io/pkg/envPred/man/env_stats.html'>env_stats</a></span>(<span class='kw'>sst</span><span class='op'>$</span><span class='kw'>time_series</span>, <span class='kw'>sst</span><span class='op'>$</span><span class='kw'>dates</span>, n_states = <span class='fl'>11</span>, delta = <span class='fl'>1</span>,
          is_uneven = <span class='fl'>FALSE</span>, interpolate = <span class='fl'>FALSE</span>, show_warns = <span class='fl'>TRUE</span>,
          noise_method = <span class='st'>'spectrum'</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Time series starts and ends at different times of the year. Starting month is January and ending month is December</span></div><div class='output co'>#&gt;   series_n n_na prop_na n_yrs n_months n_days   frequency nyquist_freq raw_mean
#&gt; 1     4017    0       0    11       12   4017 0.000497884          0.5 23.09039
#&gt;    raw_var    raw_cv predicted_var unpredicted_var unbounded_seasonality
#&gt; 1 5.109123 0.0978908      4.089987       0.7072908               5.78261
#&gt;   bounded_seasonality  env_col  colwell_c colwell_m colwell_p
#&gt; 1           0.8525641 1.716807 0.03052538 0.4583633 0.4888887</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/pkg/envPred/man/env_stats.html'>env_stats</a></span>(<span class='kw'>sst</span><span class='op'>$</span><span class='kw'>time_series</span>, <span class='kw'>sst</span><span class='op'>$</span><span class='kw'>dates</span>, n_states = <span class='fl'>11</span>, delta = <span class='fl'>1</span>,
          is_uneven = <span class='fl'>FALSE</span>, interpolate = <span class='fl'>FALSE</span>, show_warns = <span class='fl'>TRUE</span>,
          noise_method = <span class='st'>'spectrum'</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Time series starts and ends at different times of the year. Starting month is January and ending month is December</span></div><div class='output co'>#&gt;   series_n n_na prop_na n_yrs n_months n_days   frequency nyquist_freq raw_mean
#&gt; 1     4017    0       0    11       12   4017 0.000497884          0.5 23.09039
#&gt;    raw_var    raw_cv predicted_var unpredicted_var unbounded_seasonality
#&gt; 1 5.109123 0.0978908      4.089987       0.7072908               5.78261
#&gt;   bounded_seasonality  env_col  colwell_c colwell_m colwell_p
#&gt; 1           0.8525641 1.716807 0.03052538 0.4583633 0.4888887</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/pkg/envPred/man/env_stats.html'>env_stats</a></span>(<span class='kw'>sst</span><span class='op'>$</span><span class='kw'>time_series</span>, <span class='kw'>sst</span><span class='op'>$</span><span class='kw'>dates</span>, n_states = <span class='fl'>11</span>, delta = <span class='fl'>1</span>,
          is_uneven = <span class='fl'>FALSE</span>, interpolate = <span class='fl'>FALSE</span>, show_warns = <span class='fl'>TRUE</span>,
          noise_method = <span class='st'>'spectrum'</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Time series starts and ends at different times of the year. Starting month is January and ending month is December</span></div><div class='output co'>#&gt;   series_n n_na prop_na n_yrs n_months n_days   frequency nyquist_freq raw_mean
#&gt; 1     4017    0       0    11       12   4017 0.000497884          0.5 23.09039
#&gt;    raw_var    raw_cv predicted_var unpredicted_var unbounded_seasonality
#&gt; 1 5.109123 0.0978908      4.089987       0.7072908               5.78261
#&gt;   bounded_seasonality  env_col  colwell_c colwell_m colwell_p
#&gt; 1           0.8525641 1.716807 0.03052538 0.4583633 0.4888887</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/pkg/envPred/man/env_stats.html'>env_stats</a></span>(<span class='kw'>npp</span><span class='op'>$</span><span class='kw'>time_series</span>, <span class='kw'>npp</span><span class='op'>$</span><span class='kw'>dates</span>, n_states = <span class='fl'>11</span>, delta = <span class='fl'>8</span>,
          is_uneven = <span class='fl'>TRUE</span>, interpolate = <span class='fl'>FALSE</span>, show_warns = <span class='fl'>TRUE</span>,
          noise_method = <span class='st'>'lomb_scargle'</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Data contains NAs, we strongly advise setting "interpolate = FALSE" for time_series containing large continuous chunks of NAs</span></div><div class='output co'>#&gt; <span class='warning'>Warning: Time series starts and ends at different times of the year. Starting month is September and ending month is January</span></div><div class='output co'>#&gt;   series_n n_na   prop_na n_yrs n_months n_days    frequency nyquist_freq
#&gt; 1      465   58 0.1247312    12       12    465 0.0005376344       0.0625
#&gt;   raw_mean  raw_var    raw_cv predicted_var unpredicted_var
#&gt; 1 485.0939 14448.82 0.2477938      4536.062        9541.714
#&gt;   unbounded_seasonality bounded_seasonality  env_col colwell_c colwell_m
#&gt; 1             0.4753928           0.3222144 0.538234 0.1131317 0.3111578
#&gt;   colwell_p
#&gt; 1 0.4242895</div><div class='input'>
<span class='fu'><a href='https://rdrr.io/pkg/envPred/man/env_stats.html'>env_stats</a></span>(<span class='kw'>npp</span><span class='op'>$</span><span class='kw'>time_series</span>, <span class='kw'>npp</span><span class='op'>$</span><span class='kw'>dates</span>, n_states = <span class='fl'>11</span>, delta = <span class='fl'>8</span>,
          is_uneven = <span class='fl'>TRUE</span>, interpolate = <span class='fl'>TRUE</span>, show_warns = <span class='fl'>TRUE</span>,
          noise_method = <span class='st'>'lomb_scargle'</span>)</div><div class='output co'>#&gt; <span class='warning'>Warning: Time series starts and ends at different times of the year. Starting month is September and ending month is January</span></div><div class='output co'>#&gt;   series_n n_na   prop_na n_yrs n_months n_days    frequency nyquist_freq
#&gt; 1      465   58 0.1247312    12       12    465 0.0005376344       0.0625
#&gt;   raw_mean  raw_var   raw_cv predicted_var unpredicted_var
#&gt; 1 481.6442 13741.58 0.243384      4530.895         8925.82
#&gt;   unbounded_seasonality bounded_seasonality  env_col colwell_c colwell_m
#&gt; 1             0.5076167           0.3367014 0.585307 0.1131317 0.3111578
#&gt;   colwell_p
#&gt; 1 0.4242895</div><div class='input'></div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Diego Barneche, Scott Burgess.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


